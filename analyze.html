<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Ticker Analysis</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7032908618576389" crossorigin="anonymous"></script>
</head>
<body>
<header class="nav">
  <div class="nav-inner">
    <div class="brand"><div class="logo"></div> AI-Invest</div>
    <nav class="links">
      <a href="/index.html">Home</a>
      <div class="menu">
        <a href="/tools/index.html">Tools</a>
        <div class="menu-panel">
          <a href="/tools/efficient-frontier.html">Efficient Frontier</a>
          <a href="/tools/dcf.html">DCF Valuation</a>
        </div>
      </div>
      <div class="menu">
        <a href="/gpts/index.html">Custom GPTs</a>
        <div class="menu-panel">
          <a href="/gpts/etf-comparator.html">ETF Comparator GPT</a>
          <a href="/gpts/sentiment-analyst.html">Sentiment Analyst GPT</a>
          <a href="/gpts/investment-swot.html">Investment SWOT GPT</a>
        </div>
      </div>
      <a href="/prompt.html">How-To</a>
      <a href="/about.html">About</a>
    </nav>
  </div>
</header>
<main>
  <section class="section">
    <h1>Live Ticker Analysis</h1>
    <form id="analysis-form">
      <input id="ticker" type="text" placeholder="Enter stock ticker (e.g. AAPL)" class="input" required>
      <button type="submit" class="btn btn-primary">Analyze</button>
    </form>
    <div id="result" class="section"></div>
  </section>
</main>
<script>
  const form = document.getElementById('analysis-form');
  const resultDiv = document.getElementById('result');
  form.addEventListener('submit', async e => {
    e.preventDefault();
    const ticker = document.getElementById('ticker').value.trim().toUpperCase();
    resultDiv.textContent = 'Loadingâ€¦';
    try {
      const response = await fetch('/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ ticker })
      });
      const contentType = response.headers.get('content-type') || '';
      if (!contentType.includes('application/json')) {
        const text = await response.text();
        console.error('Unexpected response:', text);
        resultDiv.textContent = 'Unexpected response (see console)';
        return;
      }
      const data = await response.json();
      if (data.choices && data.choices[0].message) {
        resultDiv.textContent = data.choices[0].message.content;
      } else if (data.error) {
        resultDiv.textContent = 'Error: ' + data.error;
      } else {
        resultDiv.textContent = JSON.stringify(data, null, 2);
      }
    } catch (err) {
      resultDiv.textContent = 'Error: ' + err.message;
    }
  });
</script>
<footer>
  <p class="muted">Educational use only. No investment advice.</p>
</footer>
</body>
</html>
